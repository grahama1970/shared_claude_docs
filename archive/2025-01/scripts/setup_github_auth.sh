#!/bin/bash

echo "=== GitHub Authentication Setup for Granger Projects ==="
echo ""
echo "The Granger ecosystem requires GitHub authentication to install dependencies."
echo "This is because the projects reference private GitHub repositories."
echo ""
echo "Please choose one of these authentication methods:"
echo ""
echo "=========================================="
echo "Option 1: GitHub CLI (RECOMMENDED - Easiest)"
echo "=========================================="
echo "Run these commands:"
echo ""
echo "  gh auth login"
echo "  # Follow the prompts to authenticate"
echo ""
echo "Then test with:"
echo "  gh auth status"
echo ""
echo "=========================================="
echo "Option 2: SSH Key"
echo "=========================================="
echo "1. Generate SSH key (if you don't have one):"
echo "   ssh-keygen -t ed25519 -C 'your-email@example.com'"
echo ""
echo "2. Add the public key to GitHub:"
echo "   cat ~/.ssh/id_ed25519.pub"
echo "   # Copy and add to: https://github.com/settings/keys"
echo ""
echo "3. Test SSH connection:"
echo "   ssh -T git@github.com"
echo ""
echo "=========================================="
echo "Option 3: Personal Access Token (PAT)"
echo "=========================================="
echo "1. Create a token at: https://github.com/settings/tokens"
echo "2. Select 'repo' scope for full access"
echo "3. Configure git to use the token:"
echo ""
echo "   git config --global url.'https://YOUR_TOKEN@github.com/'.insteadOf 'https://github.com/'"
echo ""
echo "=========================================="
echo "Option 4: Use uv with authentication"
echo "=========================================="
echo "Set environment variable:"
echo "  export UV_GITHUB_TOKEN=your_github_token"
echo ""
echo "Or create ~/.config/uv/config.toml:"
echo "  [auth]"
echo "  github = 'your_github_token'"
echo ""
echo "=========================================="
echo ""
echo "After setting up authentication, run:"
echo "  cd /home/graham/workspace/shared_claude_docs"
echo "  uv sync"
echo "  uv pip install -e ."
echo ""
echo "Current authentication status:"
if command -v gh &> /dev/null; then
    echo "GitHub CLI installed: ✅"
    gh auth status 2>&1 | grep -q "Logged in" && echo "GitHub CLI authenticated: ✅" || echo "GitHub CLI authenticated: ❌"
else
    echo "GitHub CLI installed: ❌"
fi

if [ -f ~/.ssh/id_rsa ] || [ -f ~/.ssh/id_ed25519 ]; then
    echo "SSH key exists: ✅"
else
    echo "SSH key exists: ❌"
fi

echo ""
echo "For immediate help with Granger projects, the GitHub CLI method is recommended."